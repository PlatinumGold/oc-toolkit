<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>OC Family Tree</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; padding: 20px; }
    .tree { display: flex; flex-direction: column; align-items: center; }
    .row { display: flex; justify-content: center; margin: 20px 0; }
    .node {
      background: #fff;
      border: 2px solid #333;
      padding: 10px;
      margin: 10px;
      min-width: 100px;
      text-align: center;
      cursor: pointer;
      border-radius: 8px;
      position: relative;
    }
    .node input {
      border: none;
      text-align: center;
      width: 90%;
    }
    .buttons { margin-top: 10px; }
    button { margin: 2px; }
    .line {
      height: 20px;
      width: 2px;
      background: #000;
      margin: auto;
    }
    .line-horizontal {
      height: 2px;
      background: #000;
      flex: 1;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>OC Family Tree</h1>
  <p>Click any person to add a parent, partner, sibling, or child. Double-click their name to edit it.</p>
  <div id="treeContainer" class="tree"></div>

  <script>
    let selectedNode = null;
    let idCounter = 0;

    const treeData = {
      id: generateId(),
      name: 'Main OC',
      parents: [],
      siblings: [],
      partners: [],
      children: []
    };

    function generateId() {
      return 'node_' + idCounter++;
    }

    function renderTree(container, data) {
      container.innerHTML = '';

      const mainNode = createNode(data);
      container.appendChild(mainNode);
    }

    function createNode(data) {
      const wrapper = document.createElement('div');
      wrapper.className = 'tree';

      // Parents
      if (data.parents.length) {
        const parentRow = document.createElement('div');
        parentRow.className = 'row';
        data.parents.forEach(p => parentRow.appendChild(createNode(p)));
        wrapper.appendChild(parentRow);
        wrapper.appendChild(document.createElement('div')).className = 'line';
      }

      // Siblings and Main OC and Partners
      const centerRow = document.createElement('div');
      centerRow.className = 'row';

      data.siblings.forEach(s => centerRow.appendChild(createNode(s)));

      const personNode = document.createElement('div');
      personNode.className = 'node';
      personNode.dataset.id = data.id;

      const input = document.createElement('input');
      input.value = data.name;
      input.disabled = true;
      input.ondblclick = () => input.disabled = false;
      input.onblur = () => {
        input.disabled = true;
        data.name = input.value;
      };
      personNode.appendChild(input);

      const btns = document.createElement('div');
      btns.className = 'buttons';

      ['Parent', 'Sibling', 'Partner', 'Child'].forEach(type => {
        const btn = document.createElement('button');
        btn.textContent = type;
        btn.onclick = e => {
          e.stopPropagation();
          addRelative(data, type.toLowerCase());
        };
        btns.appendChild(btn);
      });

      personNode.appendChild(btns);
      centerRow.appendChild(personNode);

      data.partners.forEach(p => centerRow.appendChild(createNode(p)));

      wrapper.appendChild(centerRow);

      // Children
      if (data.children.length) {
        const childLine = document.createElement('div');
        childLine.className = 'line';
        wrapper.appendChild(childLine);

        const childRow = document.createElement('div');
        childRow.className = 'row';
        data.children.forEach(c => childRow.appendChild(createNode(c)));
        wrapper.appendChild(childRow);
      }

      return wrapper;
    }

    function addRelative(node, type) {
      const newPerson = {
        id: generateId(),
        name: type[0].toUpperCase() + type.slice(1),
        parents: [],
        siblings: [],
        partners: [],
        children: []
      };

      switch (type) {
        case 'parent':
          node.parents.push(newPerson);
          break;
        case 'sibling':
          node.siblings.push(newPerson);
          break;
        case 'partner':
          node.partners.push(newPerson);
          break;
        case 'child':
          node.children.push(newPerson);
          break;
      }

      renderTree(document.getElementById('treeContainer'), treeData);
    }

    renderTree(document.getElementById('treeContainer'), treeData);
  </script>
</body>
</html>
