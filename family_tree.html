<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>OC Family Tree</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; padding: 20px; }
    h1 { text-align: center; color: #333; }
    p { text-align: center; color: #666; }
    .tree { display: flex; flex-direction: column; align-items: center; }
    .row { display: flex; justify-content: center; margin: 20px 0; }
    .node {
      background: #fff;
      border: 2px solid #333;
      padding: 10px;
      margin: 10px;
      min-width: 100px;
      text-align: center;
      cursor: pointer;
      border-radius: 8px;
      position: relative;
    }
    .node input {
      border: none;
      text-align: center;
      width: 90%;
      font-size: 1em;
    }
    .buttons { margin-top: 8px; }
    .buttons button {
      margin: 2px;
      padding: 4px 6px;
      font-size: 0.85em;
      cursor: pointer;
    }
    .line {
      height: 20px;
      width: 2px;
      background: #000;
      margin: auto;
    }
  </style>
</head>
<body>
  <h1>OC Family Tree</h1>
  <p>Double-click a name to edit. Use the buttons to add relations.</p>
  <div id="treeContainer" class="tree"></div>

  <script>
    let idCounter = 0;
    function generateId() { return 'node_' + idCounter++; }

    // Root data
    const treeData = {
      id: generateId(),
      name: 'Main OC',
      parents: [],
      siblings: [],
      partners: [],
      affairs: [],
      children: []
    };

    // Render entire tree inside container
    function renderTree(container, data) {
      container.innerHTML = '';
      container.appendChild(createNode(data));
    }

    // Create a subtree for one person
    function createNode(data) {
      const wrapper = document.createElement('div');
      wrapper.className = 'tree';

      // Parents row
      if (data.parents.length) {
        const pr = document.createElement('div');
        pr.className = 'row';
        data.parents.forEach(p => pr.appendChild(createNode(p)));
        wrapper.appendChild(pr);
        const vline = document.createElement('div');
        vline.className = 'line';
        wrapper.appendChild(vline);
      }

      // Center row: siblings, person, partners, affairs
      const cr = document.createElement('div');
      cr.className = 'row';

      data.siblings.forEach(s => cr.appendChild(createNode(s)));

      // Person node
      const pn = document.createElement('div');
      pn.className = 'node';
      pn.dataset.id = data.id;

      // Name input
      const inp = document.createElement('input');
      inp.value = data.name;
      inp.disabled = true;
      inp.ondblclick = () => inp.disabled = false;
      inp.onblur = () => {
        inp.disabled = true;
        data.name = inp.value;
      };
      pn.appendChild(inp);

      // Buttons
      const btns = document.createElement('div');
      btns.className = 'buttons';
      ['Parent','Sibling','Partner','Affair','Child'].forEach(type => {
        const b = document.createElement('button');
        b.textContent = type;
        b.onclick = e => {
          e.stopPropagation();
          addRelative(data, type.toLowerCase());
        };
        btns.appendChild(b);
      });
      pn.appendChild(btns);

      cr.appendChild(pn);

      data.partners.forEach(p => cr.appendChild(createNode(p)));
      data.affairs.forEach(a => {
        const affairNode = createNode(a);
        // style affair nodes with red border
        affairNode.querySelector('.node').style.borderColor = '#c00';
        cr.appendChild(affairNode);
      });

      wrapper.appendChild(cr);

      // Children row
      if (data.children.length) {
        const vline2 = document.createElement('div');
        vline2.className = 'line';
        wrapper.appendChild(vline2);

        const ch = document.createElement('div');
        ch.className = 'row';
        data.children.forEach(c => ch.appendChild(createNode(c)));
        wrapper.appendChild(ch);
      }

      return wrapper;
    }

    // Add a relation to a given node
    function addRelative(node, type) {
      const np = {
        id: generateId(),
        name: type.charAt(0).toUpperCase() + type.slice(1),
        parents: [], siblings: [], partners: [], affairs: [], children: []
      };
      switch(type) {
        case 'parent': node.parents.push(np); break;
        case 'sibling': node.siblings.push(np); break;
        case 'partner': node.partners.push(np); break;
        case 'affair': node.affairs.push(np); break;
        case 'child': node.children.push(np); break;
      }
      renderTree(document.getElementById('treeContainer'), treeData);
    }

    // Initial render
    renderTree(document.getElementById('treeContainer'), treeData);
  </script>
</body>
</html>
